%!TEX root = ../dokumentation.tex

\chapter{Rahmenbedingungen}


\section{Export-Datenstruktur}

Wie bereits im Kapitel zuvor erwähnt bietet Kubios HRV Premium zwei unterschiedliche Exportmöglichkeiten. Diese werden durch den einheitlichen CSV-Standard und das MATLAB-eigenen MAT-File repräsentiert.\\
Bei einer CSV-Datei (engl. Comma-separated values) handelt es sich um einen Standard, welcher den Aufbau einer Textdatei beschreibt. Der Inhalt der Datei beschränkt sich meist auf Tabellen und Listen, welche nicht wie üblicherweise in Zeilen und Spalten aufgeteilt wird, sondern mit Hilfe von Kommas getrennt wird, wobei jede neue Zeile eine neue Datenbankzeile darstellt und jede Datenbankzeile aus einem oder mehreren Feldern besteht. CSV-Dateien finden vor allem Anwendung in Tabellenkalkulationsprogrammen und Datenbanksysteme, wie Microsoft Excel oder MySQL, welche das Format einlesen, sowie exportieren können. Aufgrund der weiten Verbreitung des Formats ist auch das Einlesen und Verarbeiten der Dateien in nahezu jeglicher Programmiersprache möglich. Vor allem Python bietet passende Bibliotheken und Funktionen.\\% https://datei.wiki/extension/csv
Das MAT-File beschreibt ein binäres Datencontainerformat, welches von MATLAB verwendet wird. Es ermöglicht das Speichern von Arrays, Variablen und Funktionen. Je nach MATLAB Version ermöglicht das Format zusätzlich die Speicherung von mehrdimensionale numerische Arrays, Zeichenarrays, Zellenarrays, Felder mit geringer Dichte, Objekte und Strukturen. Die Lesbarkeit beschränkt sich hier jedoch auch auf MATLAB und einige wenige Bibliotheken für beispielsweise Python.
% https://datei.wiki/extension/mat

Da diese beiden Export-Formate und deren Inhalt von einander verschieden sind und die Grundlage der Datenverarbeitung sowie Datenvisualisierung bilden, sollen diese im Folgenden Hinblick auf Übersichtlichkeit, Formatierung, inhaltlicher Korrektheit und Zugänglichkeit verglichen werden.\\
Die Darstellung der CSV-Datei ist unverschachtelt und befindet sich auf einer Ebene. Alle Daten lassen sich auf einmal einsehen. Innerhalb der Datei befinden sich tabellarische Strukturen der einzelnen Messdaten, aber auch Einzelinformationen, Überschriften und Bezeichner. Dies stellt für das Einlesen und Verarbeiten der Daten ein Problem dar, da zusätzlich nach relevanten gefiltert oder mehrere Formatierungsiterationen durchgeführt werden müssen. Das MAT-File hingegen ist in sich verschachtelt. Die Messdaten sind sortiert und unter ihrem jeweiligen Bereich geordnet. Der Zugriff auf die Daten erfolgt mittels Key-Value-Verfahren, das heißt unter einem Schlüsselwort befinden sich der jeweilige Datensatz. Ein Datensatz kann dabei ebenfalls von einem weiteren Key-Value-Paar dargestellt werden. Irrelevante Daten können hier gefiltert werden in dem man den jeweiligen Key einfach nicht aufruft. Das Format kann also ohne weitere Vorformatierung eingelesen werden.\\
Betrachtet man die Konstanz und Korrektheit bezogen auf die Darstellung der Daten in Kubios, lassen sich im CSV-Format einige Unregelmäßigkeiten erkennen. So sind häufig Kommas verschoben und Felder mit einer stark variierenden Anzahl Leerzeichen aufgefüllt, um eine übersichtlichere Darstellung zu ermöglichen. Dies hat jedoch den Effekt, dass diese Leerzeichen beim Einlesen mit beispielsweise Python ebenfalls im Datensatz auftauchen und diesen verunreinigen bzw. im schlimmsten Fall unbrauchbar machen. Auch hier müsste deshalb im Vorhinein ein Formatierung der grundlegenden Datei durchgeführt werden. \color{red}Diese Unregelmäßigkeiten lassen sich auf die Exportfunktionen der Kubios-Software zurückführen. \color{black}Der Inhalt des MAT-Files ist hingegen akkurat und nicht von den Unregelmäßigkeiten betroffen.\\
Daraus ergibt sich, dass das MAT-File ein grundlegend konsistenterer Datenspeicher für die medizinischen Messdaten darstellt und einen großen Vorteil im Bereich der Zugänglichkeit sowie der Reduzierung zusätzlicher Hilfsfunktionen und Datenmanipulationen gegenüber dem CSV-Format bietet. Aus diesem Grund wird dieses auch als Grundlage zur Umsetzung des Tools zur Auswertung der medizinischen Messdaten verwendet.


\section{Programmiersprache}

Im Bereich der Data Science gibt es viele unterschiedliche Programmiersprachen, welche das Bearbeiten und Auswerten großer Datenmengen ermöglichen. Je nach Anwendungsgebiet und Lösungsansätzen, sowie der dazugehörigen Eigenschaften der zu analysierenden Daten muss eine passende Programmiersprache gewählt werden. Im Hinblick auf die Anforderungen der Studienarbeit stehen vor allem das Auslesen der Daten aus vorgegebenen Datei-Formaten, das graphische Darstellen der Messdaten, sowie die Erstellung einer passenden Benutzeroberfläche im Vordergrund. 

Python ist hierbei die beliebteste und meistverwendet Programmiersprache. Sie ermöglicht das effiziente Auslesen von CSV-Datei sowie MAT-Dateien, verfügt über die Möglichkeit eine Benutzeroberfläche zu erstellen und bietet mit einer großen Anzahl zusätzlicher Bibliothek eine hohe Flexibilität. Somit ist Python perfekt auf die Anforderungen der Aufgabenstellung zugeschnitten. Da die Messdaten jedoch in der zukünftigen Implementierung aus der MAT-Datei ausgelesen werden sollen, wird auch die Umsetzung in MATLAB betrachtet. MATLAB bietet dabei auch eine Reihe von Tools zum Auswerten verschiedener Daten und das erstellen einer graphische Benutzeroberfläche. Um eine Entscheidung über die zu verwendende Programmiersprache treffen zu können werden diese im folgenden vorgestellt und anhand wichtiger Kriterien miteinander verglichen.

\subsection{Python}

Python ist eine interpretierte, objektorientiere High-Level-Programmiersprache mit einer dynamischen Semantik, welche in den Bereichen der Datenanalyse und Machine Learning, aber auch im Web Development oder für Automatisierungstasks eingesetzt wird. Sie glänzt vor allem durch ihre hochentwickelten, integrierten Datenstrukturen und dynamischer Typisierung, weshalb sie sehr attraktiv für Anwendungs- sowie Skriptentwicklung ist. Auch die einfache und leicht zu erlernende Syntax von Python, bietet einen guten Einstieg in die Programmierung, beschleunigt den Entwicklungsprozess und erleichtert die Programmpflege. Außerdem unterstützt Python eine Großzahl von Modulen und Paketen, was die Modularität von Programmen und die Wiederverwendung von Code fördert. Diese werden vor allem auch durch die große Community und deren Open-Source-Projekte weiter gefördert, weshalb grundlegende Lösungen für nahezu jedes Problem bereits bestehen. Der Python-Interpreter und die umfangreiche Standardbibliothek sind für alle wichtigen Plattformen kostenlos verfügbar und können frei verteilt werden.

% https://www.python.org/doc/essays/blurb/
% https://www.coursera.org/articles/what-is-python-used-for-a-beginners-guide-to-using-python

\subsection{MATLAB}

MATLAB ist eine High-Level-Prgrammiersprache für technische Berechnungen, welche von \textit{The MathWorks Inc.} entwickelt sowie vertrieben wird und deshalb auch eine kostenpflichtige Lizenz benötigt. Sie integriert Berechnungen, Visualisierung und Programmierung in einer einfach zu bedienenden Umgebung, in der Probleme und Lösungen in vertrauter mathematischer Notation ausgedrückt werden. Ihre Anwendungsgebiete sind dabei mathematische Berechnungen und Algorithmen-Entwicklung, sowie die Simulation und Datenanalyse, aber auch die Entwicklung von Anwendungen, einschließlich der Erstellung von graphischen Benutzeroberflächen sind möglich.\\
MATLAB basiert grundlegend auf einem Array-Datenelement, welches nicht dimensioniert werden muss. Dadurch lassen sich viele technische Berechnungsprobleme, insbesondere solche mit Matrix- und Vektorformulierungen, in einem Bruchteil der Zeit lösen, die für das Schreiben eines Programms in einer skalaren, nicht interaktiven Sprache wie C erforderlich wäre. MATLAB bietet eine Reihe anwendungsspezifischer Lösungen, die so genannten Toolboxen. Toolboxen sind umfassende Sammlungen von MATLAB-Funktionen, die die MATLAB-Umgebung erweitern, um bestimmte Problemklassen zu lösen. Zu den Bereichen, in denen Toolboxen verfügbar sind, gehören Signalverarbeitung, Steuerungssysteme, neuronale Netze, Simulation und viele andere.

% https://de.mathworks.com/discovery/what-is-matlab.html
% https://blog.devgenius.io/what-is-matlab-why-we-need-it-d61e405ef419

\subsection{Performance-Vergleich}

Um einen besseren Überblick über die Performance der beiden Programmiersprachen zur Auswertung von Messdaten zu erhalten, werden mehrere Performance-Vergleiche durchgeführt. Im ersten Schritt wird dazu ein kleiner Datensatz geöffnet und ein einfache Line-Plot erstellt. Geplottet wird jeweils die durchschnittliche Herzfrequenz aus dem normalen Datensatz der Auswertung ohne Samples. Hierbei handelt es sich um 41 Werte, welche als Line-Plot ohne weitere Konfiguration dargestellt werden. In der Python Umgebung werden die Bibliotheken \textbf{pandas} und \textbf{h5py} verwendet, da diese für ihre jeweiligen Aufgaben, Erstellen von Data Frames und Laden von mat-Files, als State-Of-The-Art gelten. Zum Plotten wird auf die \textbf{matplotlib} zurückgegriffen, da diese der MATLAB Darstellung am nächsten kommt. MATLAB ermöglicht die Auswertung ohne zusätzliche Bibliotheken. Die Zeit wird in beiden Fällen mit nativen Funktionen ausgewertet. Getestet wird auf einem MacBook mit folgenden technischen Daten. Dabei werden beide Skripts jeweils dreimal abwechselnd hintereinander ausgeführt, während sich das MacBook im Akku-betriebenem Modus befindet.

% https://pandas.pydata.org/
% https://docs.h5py.org/en/stable/

\begin{table}[H]
	\centering
	\begin{tabular}{|l|l|}
		\multicolumn{1}{l}{\textbf{Technische Daten}} & \multicolumn{1}{l}{}                       \\ 
		\hline
		Model                                         & MacBook Pro (Retina, 13-inch, Early 2015)  \\ 
		\hline
		Betriebssystem                                & macOS Montery Version 12.1                 \\ 
		\hline
		Prozessor                                     & 2,7 GHz Dual-Core Intel Core i5            \\ 
		\hline
		Arbeitsspeicher                               & 8 GB 1867 MHz DD3                          \\ 
		\hline
		Grafikchip                                    & Intel Iris Graphics 6100 1536 MB           \\
		\hline
	\end{tabular}
	\caption{Übersicht der technischen Daten des Testmediums}
\end{table}

Die Implementierungen der einzelnen Programmiersprachen, sowie die berechneten Programmlaufzeiten sind im Folgenden dargestellt. Die beiden Skripte werden jeweils fünf mal ausgeführt und der Mittelwert der berechneten Zeiten bestimmt.

\lstinputlisting[language=Matlab,numbers=left,firstline=1,lastline=4,caption={MATLAB Implementierung}]{code/speedtest.m}
\lstinputlisting[language=Python,numbers=left,firstline=1,lastline=13,caption={Python Implementierung}]{code/speedtest.py}

\begin{table}[H]
	\centering
	\caption{Technische Daten}
	\begin{tabular}{|l|l|l|}
		\multicolumn{1}{l}{\textbf{Durchlauf}} & \multicolumn{1}{l}{\textbf{MATLAB}} & \multicolumn{1}{l}{\textbf{Python}}  \\ 
		\hline
		1                                      & 0.303867 s                          & 0.359526
		s                           \\ 
		\hline
		2                                      & 0.307696
		s                          & 0.351593
		s                           \\ 
		\hline
		3                                      & 0.295474
		s                          & 0.354158
		s                           \\ 
		\hline
		4                                      & 0.301647 s                          & 0.352104 s                           \\ 
		\hline
		5                                      & 0.299218 s                          & 0.350182 s                           \\ 
		\hline
		\textbf{Mittelwert}                    & \textbf{0.301580 s}                          & \textbf{0.353512} s                           \\
		\hline
	\end{tabular}
\end{table}

MATLAB ist bei jeder Ausführung um ca. 17\% schneller als das Python Skript. Zudem muss die Komplexität der beiden Skripte betrachtet werden. In MATLAB benötigt man lediglich zwei Zeilen Code und keine zusätzlichen Bibliotheken, während das Python Skript  vier Code Zeilen und drei zusätzlichen Bibliotheken in Anspruch nimmt. Außerdem muss hier beachtet werden, dass das Anzeigen des Plots unter Python nicht mit in die Berechnung der Zeit aufgenommen werden kann, da alle Code-Zeilen nach \glqq plt.show\grqq{} auch erst nach dem Schließen des Plot-Fensters angezeigt werden.

% hier muss noch bisschen mehr Analyse hin